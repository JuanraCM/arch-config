#!/bin/bash

set -e

sudo pacman -Syu --noconfirm

# Install gaming related packages
sudo pacman -S --noconfirm --needed steam linux-headers mangohud
yay -S --noconfirm xpadneo-dkms heroic-games-launcher-bin

# Prevent xpad/xpadneo driver conflict
echo blacklist xpad | sudo tee /etc/modprobe.d/blacklist-xpad.conf >/dev/null
echo hid_xpadneo | sudo tee /etc/modules-load.d/xpadneo.conf >/dev/null

# Give user access to game controllers
sudo usermod -a -G input $USER

# Copy default MangoHud configuration
config-refresh-mangohud
